{"version":3,"file":"articles\\depiler_par_les_deux_bouts\\@depiler_par_les_deux_bouts.js.map","sources":["articles\\depiler_par_les_deux_bouts\\@depiler_par_les_deux_bouts.js","$.js","tfw.grader.js","wdg.js","x-widget.js","depiler2bouts.main.js","tp4.bulle.js","svg.triangle.js"],"sourcesContent":["var require = function() {\r\n    var modules = {};\r\n    \r\n    return function(id, body) {\r\n        var mod;\r\n        body = window[\"#\" + id];\r\n        if (typeof body === 'undefined') {\r\n            var err = new Error(\"Required module is missing: \" + id);   \r\n            console.error(err.stack);\r\n            throw err;\r\n        }\r\n        mod = modules[id];\r\n        if (typeof mod === 'undefined') {\r\n            mod = {exports: {}};\r\n            var exports = mod.exports;\r\n            body(exports, mod);\r\n            modules[id] = mod.exports;\r\n            mod = mod.exports;\r\n            //console.log(\"Module initialized: \" + id);\r\n        }\r\n        return mod;\r\n    };\r\n}();\r\nfunction addListener(e,l) {\r\n    if (window.addEventListener) {\r\n        window.addEventListener(e,l,false);\r\n    } else {\r\n        window.attachEvent('on' + e, l);\r\n    }\r\n};\r\n\r\naddListener(\r\n    'DOMContentLoaded',\r\n    function() {\r\n        document.body.parentNode.$data = {};\r\n        // Attach controllers.\r\n        try{require('x-widget')('game1','depiler2bouts.main',\"\")}catch(x){console.error('Unable to initialize depiler2bouts.main!', x)}\ntry{require('x-widget')('tfw.grader0','tfw.grader',{\r\n    header: \"function(values, F, L) {\",\r\n    footer: \"}\",\r\n    grader: function() {\r\n        function shuffle(arr) {\r\n            var i, j, tmp;\r\n            for (i = 0 ; i < arr.length ; i++) {\r\n                j = Math.floor(Math.random() * arr.length);\r\n                tmp = arr[i];\r\n                arr[i] = arr[j];\r\n                arr[j] = tmp;\r\n            }\r\n            return arr;\r\n        }\r\n\r\n        try {\r\n            this.expect([ 5, 9, 3, 6, 7, 10, 4, 1, 8, 2 ]).toBe(true);\r\n            this.expect([ 7, 3, 2, 6, 5, 9, 8, 1, 10, 4 ]).toBe(true);\r\n            this.expect([ 4, 2, 1, 5, 6, 10, 7, 3, 9, 8 ]).toBe(true);\r\n            \r\n            this.expect([1,2,3,4,5,6,7,8,9,10]).toBe(true);\r\n            this.expect([10,9,8,7,6,5,4,3,2,1]).toBe(true);\r\n            this.expect([10,7,6,3,2,1,4,5,8,9]).toBe(true);\r\n            \r\n            var arr = [1,2,3,4,5,6,7,8,9,10];\r\n            for (var loop=0 ; loop<1000 ; loop++) {\r\n                shuffle(arr);\r\n                this.expect(arr).toBe(true);\r\n            }\r\n        }\r\n        catch (ex) {\r\n            if (ex.args) {\r\n                this.fail(\"Votre programme a perdu dans cette configuration : \"\r\n                          + JSON.stringify(ex.args[0]));\r\n            }\r\n            throw ex;\r\n        }\r\n    },\r\n    wrapper: function(f) {\r\n        function max(values, F, L) {\r\n            if (F >= L) return values[F];\r\n            return Math.max(\r\n                values[F] + min(values, F + 1, L),\r\n                values[L] + min(values, F, L - 1)\r\n            );\r\n        }\r\n\r\n        function min(values, F, L) {\r\n            if (F >= L) return -values[F];\r\n            return Math.min(\r\n                    - values[F] + max(values, F + 1, L),\r\n                    - values[L] + max(values, F, L - 1)\r\n            );\r\n        }\r\n\r\n        return function(values) {\r\n            var gain = 0;\r\n            var F = 0;\r\n            var L = values.length - 1;\r\n            var choice;\r\n            while (F < L) {\r\n                choice = f(values, F, L);\r\n                if (choice == 0) {\r\n                    gain += values[F]; F++;\r\n                }\r\n                else if (choice == 1) {\r\n                    gain += values[L]; L--;\r\n                }\r\n                else {\r\n                    throw {\r\n                        fail: \"Votre fonction devrait retourner 0 pour dire de prendre la première pièce\\net 1 pour la dernière.\\nMalheureusement, elle vient de retourner \" + JSON.stringify(choice)\r\n                    };\r\n                }\r\n                choice = max(values, F + 1, L) - values[F] < max(values, F, L - 1) - values[L] \r\n                    ? 0 : 1;\r\n                if (choice == 0) {\r\n                    gain -= values[F++];\r\n                }\r\n                else if (choice == 1) {\r\n                    gain -= values[L--];\r\n                }\r\n            }\r\n            return gain > 0;\r\n        };\r\n    }\r\n}\r\n)}catch(x){console.error('Unable to initialize tfw.grader!', x)}\ntry{require('x-widget')('game2','depiler2bouts.main',true)}catch(x){console.error('Unable to initialize depiler2bouts.main!', x)}\r\n    }\r\n);\r\n","window['#$']=function(exports,module){  exports.config={\n    name:\"grenier\",\n    description:\"Articles concernant majoritairement l'algorithmie\",\n    author:\"Tolokoban\",\n    version:\"1.0.512\",\n    major:1,\n    minor:0,\n    revision:512,\n    date:new Date(2016,1,4,14,44,39)\n};\nvar currentLang = null;\r\nexports.lang = function(lang) {\r\n    if (lang === undefined) {\r\n        lang = window.localStorage.getItem(\"Language\");\r\n        if (!lang) {\r\n            lang = window.navigator.language;\r\n            if (!lang) {\r\n                lang = window.navigator.browserLanguage;\r\n                if (!lang) {\r\n                    lang = \"fr\";\r\n                }\r\n            }\r\n        }\r\n        lang = lang.substr(0, 2).toLowerCase();\r\n    }\r\n    currentLang = lang;\r\n    window.localStorage.setItem(\"Language\", lang);\r\n    return lang;\r\n};\r\nexports.intl = function(words, params) {\r\n    var dic = words[exports.lang()],\r\n    k = params[0],\r\n    txt, newTxt, i, c, lastIdx, pos;\r\n    if (!dic) {\r\n        //console.error(\"Missing internationalization for language : \\\"\" + exports.lang() + \"\\\"!\");\r\n        return k;\r\n    }\r\n    txt = dic[k];\r\n    if (!txt) {\r\n        //console.error(\"Missing internationalization [\" + exports.lang() + \"]: \\\"\" + k + \"\\\"!\");\r\n        return k;\r\n    }\r\n    if (params.length > 1) {\r\n        newTxt = \"\";\r\n        lastIdx = 0;\r\n        for (i = 0 ; i < txt.length ; i++) {\r\n            c = txt.charAt(i);\r\n            if (c === '$') {\r\n                newTxt += txt.substring(lastIdx, i);\r\n                i++;\r\n                pos = txt.charCodeAt(i) - 48;\r\n                if (pos < 0 || pos >= params.length) {\r\n                    newTxt += \"$\" + txt.charAt(i);\r\n                } else {\r\n                    newTxt += params[pos];\r\n                }\r\n                lastIdx = i + 1;\r\n            } else if (c === '\\\\') {\r\n                newTxt += txt.substring(lastIdx, i);\r\n                i++;\r\n                newTxt += txt.charAt(i);\r\n                lastIdx = i + 1;\r\n            }\r\n        }\r\n        newTxt += txt.substr(lastIdx);\r\n        txt = newTxt;\r\n    }\r\n    return txt;\r\n};\r\n }\r\n","window['#tfw.grader']=function(exports,module){  \"use strict\";\r\nvar Widget = require(\"wdg\");\r\nvar D = Widget.div;\r\nvar T = Widget.tag;\r\n\r\n/****************************************\r\n@example\r\nvar Grader = require(\"tfw.grader\");\r\nvar options = {\r\n  header: \"function(textToReverse) {\";\r\n  footer: \"}\";\r\n  grader: function(resolve, reject) {\r\n    this.expect(\"Hello!\").toBe(\"!olleH\");\r\n    this.expect(\"bob\").toBe(\"bob\");\r\n }\r\n};\r\nvar instance = new Grader(options);\r\n\r\n@class Grader\r\n****************************************/\r\nvar Grader = function(options) {\r\nconsole.info(\"[tfw.grader] options=\", options);\r\n    var that = this;\r\n\r\n    Widget.call(this);\r\n    this.addClass(\"tfw-grader\");\r\n    this._options = options;\r\n    if (options.header) {\r\n        this.append(T('pre').text(options.header));\r\n    }\r\n    var area = T(\"textarea\").attr({cols: 80, rows: 12});\r\n    area.text(localStorage.getItem('grader#' + this.attr('id')) || '');\r\n    this.append(area);\r\n    if (options.footer) {\r\n        this.append(T('pre').text(options.footer));\r\n    }\r\n    var btn = Widget.tag('button').text(\"Valider\").Tap(function() {\r\n        that.grade(area.element().value);\r\n        localStorage.setItem('grader#' + this.attr('id'), area.element().value);\r\n    });\r\n    var ok = Widget.tag('div').addClass('ok');\r\n    var error = Widget.tag('pre').addClass('error');\r\n    this.append(btn, ok, error);\r\n    this._btn = btn;\r\n    this._ok = ok;\r\n    this._error = error;\r\n\r\n    area.element().addEventListener('keyup', function() {\r\n        btn.removeAttr(\"disabled\");\r\n        error.text('');\r\n        ok.text('').removeClass('show');\r\n    });\r\n};\r\n\r\n// Extension of Widget.\r\nGrader.prototype = Object.create(Widget.prototype);\r\nGrader.prototype.constructor = Grader;\r\n\r\n/**\r\n * @return void\r\n */\r\nGrader.prototype.grade = function(testContent) {\r\n    var opt = this._options;\r\n    if (opt.header) testContent = opt.header + testContent;\r\n    if (opt.footer) testContent += opt.footer;\r\n    \r\n    var f;\r\n    try {\r\n        eval(\"f=\" + testContent);\r\n    }\r\n    catch(ex) {\r\n        console.error(ex);\r\n        return this.fail(\"La syntaxe de votre code est invalide!\\n\" + ex);\r\n    }\r\n\r\n    var wrapper;\r\n    try {\r\n        wrapper = this.wrapper(f);\r\n    }\r\n    catch(ex) {\r\n        console.error(ex);\r\n        return this.fail(\"Le grader lui-même a provoqué une exception!\\n\" + ex);\r\n    }\r\n\r\n    var grader = opt.grader;\r\n\r\n    if (typeof grader !== 'function') {\r\n        return this.fail(\"Ce grader n'a pas de fonction de vérification!\");\r\n    }\r\n    \r\n    try {\r\n        var jasmine = new Jasmine(wrapper);\r\n        grader.call(jasmine);\r\n        this._ok.text(\"Votre code est correct. Bravo !\").addClass('show');\r\n    }\r\n    catch(ex) {\r\n        console.error(ex);\r\n        if (ex && ex.fail) {\r\n            return this.fail(ex.fail);\r\n        } else {\r\n            return this.fail(\"Votre code a déclenché une exception!\\n\" + ex);\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nGrader.prototype.fail = function(txt) {\r\n    this._btn.attr(\"disabled\", \"disabled\");\r\n    this._error.text(txt);\r\n};\r\n\r\n\r\n/**\r\n * @return wrapper function which will call the tested function.\r\n */\r\nGrader.prototype.wrapper = function(f) {\r\n    if (typeof this._options.wrapper !== 'function') {\r\n        return f;\r\n    }\r\n    return this._options.wrapper(f);\r\n};\r\n\r\n\r\nGrader.create = function(options) {\r\n    return new Grader(options);\r\n};\r\nmodule.exports = Grader;\r\n\r\n\r\n\r\nfunction Jasmine(wrapper) {\r\n    this._runtime = null;\r\n    this._wrapper = wrapper;\r\n};\r\n\r\nJasmine.prototype.fail = function(msg) {\r\n    throw {fail: msg};\r\n};\r\n\r\nJasmine.prototype.expect = function() {\r\n    try {\r\n        var args = [], i;\r\n        for (i = 0 ; i < arguments.length ; i++) {\r\n            args.push(arguments[i]);\r\n        }\r\n        var result = this._wrapper.apply(this, args);\r\n        var runtime = new Runtime(result, args);\r\n        return runtime;\r\n    }\r\n    catch(ex) {\r\n        if (ex.fail) {\r\n            throw ex;\r\n        }\r\n        throw {fail: \"Votre code a provoqué une exception!\\n\" + ex};\r\n    }\r\n}\r\n\r\n\r\nfunction Runtime(result, args) {\r\n    this._inverted = 0;\r\n    this._result = result;\r\n    this._args = args;\r\n}\r\n\r\nRuntime.prototype.not = function() {\r\n    this._inverted = 1 - this._inverted;\r\n    return this;\r\n};\r\n\r\nRuntime.prototype.toBe = function(value) {\r\n    if (this._inverted) {\r\n        if (this._result === value) {\r\n            throw {\r\n                fail: \"Expected \" + JSON.stringify(this._result)\r\n                    + \" NOT to be \" + JSON.stringify(value) + \"!\",\r\n                expected: value,\r\n                result: this._result,\r\n                args: this._args\r\n            };\r\n        }\r\n    } else {\r\n        if (this._result !== value) {\r\n            throw {\r\n                fail: \"Expected \" + JSON.stringify(this._result)\r\n                    + \" to be \" + JSON.stringify(value) + \"!\",\r\n                expected: value,\r\n                result: this._result,\r\n                args: this._args\r\n            };\r\n        }\r\n    }\r\n};\r\n }\r\n","window['#wdg']=function(exports,module){  'use strict';\r\n\r\n/**\r\n * Widgets inherit this class.\r\n */\r\nfunction Widget(options) {\r\n    this.__data = {};\r\n    try {\r\n        var e;\r\n        if (typeof options === 'undefined') options = {};\r\n        if (typeof options.innerHTML !== 'undefined' && typeof options.childNodes !== 'undefined') {\r\n            // On passe directement un élément.\r\n            options = {element: options};\r\n        }\r\n        if (typeof options.tag === 'undefined') options.tag = \"div\";\r\n        if (options.element) {\r\n            this.element(options.element);\r\n        } else if (typeof options.id !== 'undefined') {\r\n            e = window.document.getElementById(options.id);\r\n            if (!e) {\r\n                throw Error(\"Can't find element with id: \\\"\" + options.id + \"\\\"!\");\r\n            }\r\n            this.element(e);\r\n        } else {\r\n            this.element(window.document.createElement(options.tag));\r\n            this.addClass(\"wdg\", \"custom\");\r\n        }\r\n    }\r\n    catch (ex) {\r\n        console.error(\"[widget] \", ex);\r\n        console.error(\"[Widget] \", JSON.stringify(options));\r\n        throw Error(ex);\r\n    }\r\n}\r\n\r\nWidget.prototype = {\r\n    /**\r\n     * Accessor for attribute element\r\n     * @return element\r\n     */\r\n    element: function(v) {\r\n        if (v === undefined) return this._element;\r\n        if (typeof v === 'string') {\r\n            v = window.document.querySelector(v);\r\n        }\r\n        this._element = v;\r\n        return this;\r\n    },\r\n\r\n    data: function(k, v) {\r\n        if (typeof v === 'undefined') {\r\n            return this.__data[k];\r\n        }\r\n        this.__data[k] = v;\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * @description\r\n     * Remove this element from its parent.\r\n     * @memberof wdg\r\n     */\r\n    detach: function() {\r\n        var e = this._element;\r\n        if (e) {\r\n            var p = e.parentNode;\r\n            if (p) {\r\n                p.removeChild(e);\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * @description\r\n     *\r\n     * @param name\r\n     * @memberof wdg\r\n     */\r\n    addEvent: function(name, slot, sender) {\r\n        if (typeof slot === 'string') {\r\n            var that = this, key = slot;\r\n            if (typeof sender === 'undefined') sender = this;\r\n            slot = function(x) {\r\n                var f = sender[key];\r\n                if (typeof f === 'function') {\r\n                    f.call(sender, x);\r\n                } else {\r\n                    throw Error(\"\\\"\" + slot + \"\\\" is not a function of: \" + sender);\r\n                }\r\n            };\r\n        }\r\n        var e = this.element();\r\n        if (name == 'tap') {\r\n            e.addEventListener(\r\n                \"mousedown\",\r\n                function(evt) {\r\n                    evt.preventDefault();\r\n                    evt.stopPropagation();\r\n                },\r\n                false\r\n            );\r\n            e.addEventListener(\r\n                \"mouseup\",\r\n                function(evt) {\r\n                    evt.preventDefault();\r\n                    evt.stopPropagation();\r\n                    slot(evt);\r\n                },\r\n                false\r\n            );\r\n            e.addEventListener(\"touchend\", slot, false);\r\n\r\n        } else {\r\n            e.addEventListener(name, slot, false);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Retire un attribut à l'élément sous-jacent.\r\n     * @example\r\n     * this.removeAttr(\"selected\");\r\n     * @memberof wdg\r\n     */\r\n    removeAttr: function() {\r\n        if (this._element) {\r\n            var i, arg;\r\n            for (i = 0 ; i < arguments.length ; i++) {\r\n                arg = arguments[i];\r\n                this._element.removeAttribute(arg);\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Teste l'existence d'un attribut dans l'élément sous-jacent.\r\n     * @memberof wdg\r\n     */\r\n    hasAttribute: function(key) {\r\n        if (!this._element) return false;\r\n        return this._element.hasAttribute(key);\r\n    },\r\n\r\n    /**\r\n     * Lit ou affecte la valeur d'un attribut de l'élément sous-jacent.\r\n     * @example\r\n     * // Le pseudo attribut '$' sert à insérer du texte.\r\n     * var div = new Widget();\r\n     * div.attr({$: 'Hello world!', title: 'Typical first sentence...'});\r\n     * @param key Nom de l'attribut ou dictionnaire des attributs.\r\n     * @param val [Facultatif] Valeur de l'attribut. Si elle est omise, la méthode retourne la valeur actuelle.\r\n     * @param ns [Facultatif] Namespace éventuel.\r\n     * @memberof wdg\r\n     */\r\n    attr: function(key, val, ns) {\r\n        var k;\r\n        if (!this._element || !this._element.getAttribute) return null;\r\n        if (typeof key == \"string\") {\r\n            if (val !== undefined) {\r\n                if (key == \"class\") {\r\n                    this._element.className = val;\r\n                    return this;\r\n                }\r\n                if (ns && this._element.setAttributeNS) {\r\n                    this._element.setAttributeNS(ns, key, val);\r\n                }\r\n                else {\r\n                    this._element.setAttribute(key, val);\r\n                }\r\n                return this;\r\n            }\r\n            return this._element.getAttribute(key);\r\n        }\r\n        if (typeof key == \"object\") {\r\n            for (k in key) {\r\n                if (k == \"class\") {\r\n                    this._element.className = key[k];\r\n                } else if (k == \"$\") {\r\n                    this.text(key[k]);\r\n                } else {\r\n                    this._element.setAttribute(k, key[k]);\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n\r\n\r\n    /**\r\n     * Permet de changer le style de l'élément sous-jacent.\r\n     * @example\r\n     * this.css(\"color\", \"red\");\r\n     * alert(this.css(\"display\"));\r\n     * this.css(\r\n     *   {\r\n     *     margin: \"0px\",\r\n     *     padding: \"3px\",\r\n     *     border: \"1px solid black\"\r\n     *   }\r\n     * );\r\n     * @param key Nom du champ de style ou dictionnaire clefs/valeurs.\r\n     * @param val  Valeur du champ key.  S'il est omis et  que \"key\"\r\n     * est  de type  string,  alors la  méthode  retourne la  valeur\r\n     * actuelle.\r\n     * @memberof wdg\r\n     */\r\n    css: function(key, val) {\r\n        var k, e = this._element;\r\n        if (!e) return null;\r\n        if (typeof e.style !== 'object') {\r\n            console.error(\"[wdg.css] This element does not support styles!\", e);\r\n            e.style = {};\r\n        }\r\n        if (typeof key == 'string') {\r\n            if (val) {\r\n                e.style[key] = val;\r\n                return this;\r\n            }\r\n            return e.style[key];\r\n        }\r\n        if (typeof key == 'object') {\r\n            for (k in key) {\r\n                try {\r\n                    e.style[k] = key[k];\r\n                } catch (x) {\r\n                    console.error(\"[wdg.css] Bad CSS attribute \" + k + \": \" + key[k]);\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n\r\n    insertAfter: function(target) {\r\n        if (typeof target.element === 'function') {\r\n            target = target.element();\r\n        }\r\n        target.parentNode.insertBefore(this.element(), target.nextSibling);\r\n        return this;\r\n    },\r\n\r\n    insertBefore: function(target) {\r\n        if (typeof target.element === 'function') {\r\n            target = target.element();\r\n        }\r\n        target.parentNode.insertBefore(this.element(), target);\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Append children to this widget.\r\n     */\r\n    append: function() {\r\n        var i, arg;\r\n        for (i = 0 ; i < arguments.length ; i++) {\r\n            arg = arguments[i];\r\n            if (typeof arg === 'number') arg = \"\" + arg;\r\n            if (typeof arg === 'undefined' || (typeof arg !== 'object' && typeof arg !== 'string')) {\r\n                console.error(\"[Widget.append] Argument #\" + i + \" is invalid!\", arguments);\r\n                console.error(\"[Widget.append] Is type is: \" + (typeof arg));\r\n                continue;\r\n            };\r\n            if (typeof arg === 'string') {\r\n                if (arg.length < 1) arg = \" \";\r\n                arg = window.document.createTextNode(arg);\r\n                if (!arg) {\r\n                    console.error(\r\n                        \"[Widget.append] Unable to create a text node with this text: \", arg\r\n                    );\r\n                    console.error(\"[wdg] arguments=...\", arguments);\r\n                    throw Error(\r\n                        \"[Widget.append] Unable to create a text node with this text: \"\r\n                            + JSON.stringify(arg)\r\n                    );\r\n                }\r\n            }\r\n            if (Array.isArray(arg)) {\r\n                arg.forEach(\r\n                    function(item) {\r\n                        this.append(item);\r\n                    }, this\r\n                );\r\n            } else {\r\n                var e = typeof arg.element === 'function' ? arg.element() : arg;\r\n                this._element.appendChild(e);\r\n                /*\r\n                 if (typeof arg.onAppend === 'function') {\r\n                 arg.onAppend.call(arg);\r\n                 }\r\n                 */\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * @description\r\n     * Append this widget to a parent.\r\n     * @param parent\r\n     * @memberof wdg\r\n     */\r\n    appendTo: function(parent) {\r\n        if (!parent) return this;\r\n        if (typeof parent.append === 'function') {\r\n            parent.append(this);\r\n        } else if (typeof parent.appendChild === 'function') {\r\n            parent.appendChild(this._element);\r\n            this.onAppend();\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * @description\r\n     * Append this widget to BODY.\r\n     * @memberof wdg\r\n     */\r\n    appendToBody: function() {\r\n        window.document.body.appendChild(this._element);\r\n        return this;\r\n    },\r\n\r\n    hasClass: function() {\r\n        var e = this._element.classList;\r\n        var i, arg;\r\n        for (i = 0 ; i < arguments.length ; i++) {\r\n            arg = arguments[i];\r\n            if (!e.contains(arg)) return false;\r\n        }\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * @description\r\n     * Add CSS classe(s) to this widget.\r\n     * @memberof wdg\r\n     */\r\n    addClass: function() {\r\n        var e = this._element.classList;\r\n        var i, arg;\r\n        for (i = 0 ; i < arguments.length ; i++) {\r\n            arg = arguments[i];\r\n            if (typeof arg === 'string') {\r\n                arg = arg.trim();\r\n                if (arg.length > 0) e.add(arg);\r\n            } else {\r\n                console.error(\"[wdg.addClass] Arguments with bad type!\", arguments);\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * @description\r\n     * Remove CSS classe(s) to this widget.\r\n     * @memberof wdg\r\n     */\r\n    removeClass: function() {\r\n        var e = this._element.classList;\r\n        var i, arg;\r\n        for (i = 0 ; i < arguments.length ; i++) {\r\n            arg = arguments[i];\r\n            e.remove(arg);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * @description\r\n     * Toggle CSS classe(s) to this widget.\r\n     * @memberof wdg\r\n     */\r\n    toggleClass: function() {\r\n        var e = this._element.classList;\r\n        var i, arg;\r\n        for (i = 0 ; i < arguments.length ; i++) {\r\n            arg = arguments[i];\r\n            e.toggle(arg);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Remove all children of this widget.\r\n     * Any argument passed will be appended to this widget.\r\n     * @memberof wdg\r\n     */\r\n    clear: function() {\r\n        // (!) On préfère retirer les éléments un par un du DOM plutôt que d'utiliser simplement\r\n        // this.html(\"\").\r\n        // En effet, le code simplifié a des conséquences inattendues dans IE9 et IE10 au moins.\r\n        // Le bug des markers qui disparaissaients sur les cartes de Trail-Passion 4 a été corrigé\r\n        // avec cette modification.\r\n        var e = this.element();\r\n        while(e.firstChild){\r\n            e.removeChild(e.firstChild);\r\n        }\r\n        var i, arg;\r\n        for (i = 0 ; i < arguments.length ; i++) {\r\n            arg = arguments[i];\r\n            this.append(arg);\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * 1) Sans argument, cette  fonction retourne le texte contenu\r\n     * dans ce widget.\r\n     * 2) Avec  un texte en  argument, cette fonction  retire tous\r\n     * les  enfants de  ce widget  et  les remplace  par un  noeud\r\n     * texte.\r\n     * 3)  Avec un  élément  du DOM  en  argument, cette  fonction\r\n     * retourne le texte contenu par ce dernier.\r\n     * @memberof tfw.Widget\r\n     */\r\n    text: function(arg) {\r\n        var e, text, i, child;\r\n        if (typeof arg == 'string' || typeof arg == 'number') {\r\n            this.clear();\r\n            this._element.appendChild(window.document.createTextNode(arg));\r\n            return this;\r\n        } else {\r\n            // On retourne le contenu textuel de ce widget.\r\n            e = this._element;\r\n            if (arg !== undefined) {\r\n                // On peut passer un élément du DOM pour en extraire son contenu textuel.\r\n                e = arg;\r\n            }\r\n            text = \"\";\r\n            if (e.childNodes) {\r\n                for (i=0 ; i<e.childNodes.length ; i++) {\r\n                    child = e.childNodes[i];\r\n                    if (child.nodeType == 3) {\r\n                        if (child.nodeValue) {\r\n                            text += child.nodeValue;\r\n                        }\r\n                    } else {\r\n                        text += this.text( child );\r\n                    }\r\n                }\r\n            }\r\n            return text;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * @description\r\n     *\r\n     * @param html\r\n     * @memberof wdg\r\n     */\r\n    html: function(html) {\r\n        if (typeof html === 'undefined') return this._element.innerHTML;\r\n        if (this._element) this._element.innerHTML = html;\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * @description\r\n     * If applicable, give focus to this element.\r\n     * @memberof wdg\r\n     */\r\n    focus: function() {\r\n        var e = this._element;\r\n        if (!e) return this;\r\n        if (typeof e.focus === 'function') {\r\n            e.focus();\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * @description\r\n     * Returns the bounds of the underlying element.\r\n     * @memberof wdg\r\n     */\r\n    rect: function() {\r\n        var e = this._element;\r\n        if (!e) return null;\r\n        return e.getBoundingClientRect();\r\n    },\r\n\r\n    /**\r\n     * @description\r\n     *\r\n     * @param\r\n     * @memberof wdg\r\n     */\r\n    Tap: function(slot, sender) {\r\n        if (typeof slot === 'undefined') return this._Tap;\r\n        var that = this;\r\n        if (typeof sender === 'undefined') sender = that;\r\n        if (typeof slot === 'string') slot = sender[slot];\r\n        if (!this._Tap) {\r\n            this.activatePointerEvents();\r\n        }\r\n        this._Tap = [slot, sender];\r\n        return this;\r\n    }\r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nWidget.prototype.activatePointerEvents = function() {\r\n    if (this._pointerEvents) return this;\r\n    this._pointerEvents = {start: 0};\r\n\r\n    /*\r\n     interact(this.element()).on(\"tap\", function(evt) {\r\n     var slot = that._Tap;\r\n     if (slot) {\r\n     slot[0].call(slot[1], {x: evt.x, y: evt.y});\r\n     }\r\n     });\r\n     return this;\r\n     */\r\n    var pe = this._pointerEvents;\r\n    var that = this;\r\n    this.addEvent(\r\n        \"touchstart\",\r\n        function(evt) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n            pe.touch = 1;\r\n            pe.start = Date.now();\r\n        }\r\n    );\r\n    this.addEvent(\r\n        \"touchend\",\r\n        function(evt) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n            var tap = that._Tap;\r\n            if (!tap) return;\r\n            pe.touch = 0;\r\n            var delta = Date.now() - pe.start;\r\n            if (delta > 50) {\r\n                tap[0].call(tap[1], evt);\r\n            }\r\n        }\r\n    );\r\n    this.addEvent(\r\n        \"mousedown\",\r\n        function(evt) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n            if (pe.touch) return;\r\n            pe.start = Date.now();\r\n        }\r\n    );\r\n    this.addEvent(\r\n        \"mouseup\",\r\n        function(evt) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n            var tap = that._Tap;\r\n            if (!tap) return;\r\n            var delta = Date.now() - pe.start;\r\n            if (delta > 50) {\r\n                tap[0].call(tap[1], evt);\r\n            }\r\n        }\r\n    );\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nWidget.prototype.div = function() {\r\n    var div = new Widget();\r\n    for (var i = 0 ; i < arguments.length ; i++) {\r\n        div.addClass(arguments[i]);\r\n    }\r\n    return div;\r\n};\r\n\r\nWidget.prototype.tag = function(tag) {\r\n    if (typeof tag === 'undefined') tag = 'div';\r\n    var div = new Widget({tag: tag});\r\n    for (var i = 1 ; i < arguments.length ; i++) {\r\n        div.addClass(arguments[i]);\r\n    }\r\n    return div;\r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nWidget.prototype.isInDOM = function() {\r\n    return Widget.isInDOM(this.element());\r\n};\r\n\r\n/**\r\n * Fonction à surcharger  si on veut réagir lors de  l'insertion dans le\r\n * DOM.\r\n */\r\nWidget.prototype.onAppend = function() {};\r\n\r\nWidget.create = function(args) {\r\n    return new Widget(args);\r\n};\r\n\r\nWidget.find = function(query) {\r\n    return new Widget({element: window.document.querySelector(query)});\r\n};\r\n\r\n\r\n/**\r\n * Create a SVG élément with attributes.\r\n */\r\nWidget.svg = function(tag, attribs) {\r\n    var namespace = \"http://www.w3.org/2000/svg\";\r\n    if (typeof tag === 'object') {\r\n        attribs = tag;\r\n        tag = \"svg\";\r\n    }\r\n    if (typeof tag !== 'string') tag = 'svg';\r\n    var e = window.document.createElementNS(namespace, tag);\r\n    var w = new Widget({element: e});\r\n    if (typeof attribs === 'undefined') attribs = {};\r\n    if (tag == 'svg') {\r\n        if (typeof attribs.version === 'undefined') attribs.version = \"1.1\";\r\n        if (typeof attribs['xmlns:svg'] === 'undefined') {\r\n            attribs['xmlns:svg'] = 'http://www.w3.org/2000/svg';\r\n        }\r\n        if (typeof attribs['xmlns'] === 'undefined') {\r\n            attribs['xmlns'] = 'http://www.w3.org/2000/svg';\r\n        }\r\n        if (typeof attribs['xmlns:xlink'] === 'undefined') {\r\n            attribs['xmlns:xlink'] = 'http://www.w3.org/1999/xlink';\r\n        }\r\n        if (typeof attribs.viewBox === 'undefined'\r\n            && typeof attribs.width === 'number'\r\n            && typeof attribs.height === 'number')\r\n        {\r\n            attribs.viewBox = \"0 0 \" + attribs.width + \" \" + attribs.height;\r\n        }\r\n    }\r\n    if (typeof attribs === 'object') {\r\n        w.attr(attribs);\r\n    }\r\n    return w;\r\n};\r\n\r\n/**\r\n * Tester si le widget ou élément est actuellement attaché au DOM.\r\n */\r\nWidget.isInDOM = function(e) {\r\n    if (!e) return false;\r\n    if (typeof e.element === 'function') {\r\n        e = e.element();\r\n    }\r\n    if (e === window.document) return true;\r\n    return Widget.isInDOM(e.parentNode);\r\n};\r\n\r\n\r\n/**\r\n * Create a DIV and apply all arguments as classes to it.\r\n */\r\nWidget.div = function() {\r\n    var div = new Widget({tag: \"div\"});\r\n    for (var i = 0 ; i < arguments.length ; i++) {\r\n        div.addClass(arguments[i]);\r\n    }\r\n    return div;\r\n};\r\n\r\n/**\r\n * Create a SPAN and apply all arguments as classes to it.\r\n */\r\nWidget.span = function() {\r\n    var div = new Widget({tag: \"span\"});\r\n    for (var i = 0 ; i < arguments.length ; i++) {\r\n        div.addClass(arguments[i]);\r\n    }\r\n    return div;\r\n};\r\n\r\nWidget.tag = function(tag) {\r\n    if (typeof tag === 'undefined') tag = 'div';\r\n    var div = new Widget({tag: tag});\r\n    for (var i = 1 ; i < arguments.length ; i++) {\r\n        div.addClass(arguments[i]);\r\n    }\r\n    return div;\r\n};\r\n\r\nWidget.id = function(id) {\r\n    return new Widget({element: window.document.getElementById(id)});\r\n};\r\n\r\n/**\r\n * Widget defining the `document.body` element.\r\n */\r\nWidget.body = new Widget(window.document.body);\r\n\r\nmodule.exports = Widget;\r\n\r\n\r\n\r\n/*\r\n * classList.js: Cross-browser full element.classList implementation.\r\n * 2014-07-23\r\n *\r\n * http://purl.eligrey.com/github/classList.js/blob/master/classList.js\r\n *\r\n * By Eli Grey, http://eligrey.com\r\n * Public Domain.\r\n * NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.\r\n */\r\n\r\n// Full polyfill for browsers with no classList support\r\nif (!(\"classList\" in window.document.createElement(\"_\"))) {\r\n    (function () {\r\n        \"use strict\";\r\n\r\n        if (!('Element' in window)) return;\r\n\r\n        var classListProp = \"classList\";\r\n        var protoProp = \"prototype\";\r\n        var elemCtrProto = window.Element[protoProp];\r\n        var objCtr = Object;\r\n        var strTrim = String.prototype.trim || function () {\r\n            var rx = new RegExp(\"^\\\\s+|\\\\s+$\", \"g\");\r\n            return this.replace(rx, '');\r\n        };\r\n        var arrIndexOf = Array[protoProp].indexOf || function (item) {\r\n            var\r\n            i = 0\r\n            , len = this.length\r\n            ;\r\n            for (; i < len; i++) {\r\n                if (i in this && this[i] === item) {\r\n                    return i;\r\n                }\r\n            }\r\n            return -1;\r\n        }\r\n        // Vendors: please allow content code to instantiate DOMExceptions\r\n        , DOMEx = function (type, message) {\r\n            this.name = type;\r\n            this.code = DOMException[type];\r\n            this.message = message;\r\n        }\r\n        , checkTokenAndGetIndex = function (classList, token) {\r\n            if (token === \"\") {\r\n                throw new DOMEx(\r\n                    \"SYNTAX_ERR\"\r\n                    , \"An invalid or illegal string was specified\"\r\n                );\r\n            }\r\n            if ((new RegExp(\"\\\\s\")).test(token)) {\r\n                throw new DOMEx(\r\n                    \"INVALID_CHARACTER_ERR\"\r\n                    , \"String contains an invalid character\"\r\n                );\r\n            }\r\n            return arrIndexOf.call(classList, token);\r\n        }\r\n        , ClassList = function (elem) {\r\n            var\r\n            trimmedClasses = strTrim.call(elem.getAttribute(\"class\") || \"\")\r\n            , classes = trimmedClasses ? trimmedClasses.split(new RegExp(\"\\\\s+\")) : []\r\n            , i = 0\r\n            , len = classes.length\r\n            ;\r\n            for (; i < len; i++) {\r\n                this.push(classes[i]);\r\n            }\r\n            this._updateClassName = function () {\r\n                elem.setAttribute(\"class\", this.toString());\r\n            };\r\n        }\r\n        , classListProto = ClassList[protoProp] = []\r\n        , classListGetter = function () {\r\n            return new ClassList(this);\r\n        }\r\n        ;\r\n\r\n        // Most DOMException implementations don't allow calling DOMException's toString()\r\n        // on non-DOMExceptions. Error's toString() is sufficient here.\r\n        DOMEx[protoProp] = Error[protoProp];\r\n        classListProto.item = function (i) {\r\n            return this[i] || null;\r\n        };\r\n        classListProto.contains = function (token) {\r\n            token += \"\";\r\n            return checkTokenAndGetIndex(this, token) !== -1;\r\n        };\r\n        classListProto.add = function () {\r\n            var\r\n            tokens = arguments\r\n            , i = 0\r\n            , l = tokens.length\r\n            , token\r\n            , updated = false\r\n            ;\r\n            do {\r\n                token = tokens[i] + \"\";\r\n                if (checkTokenAndGetIndex(this, token) === -1) {\r\n                    this.push(token);\r\n                    updated = true;\r\n                }\r\n            }\r\n            while (++i < l);\r\n\r\n            if (updated) {\r\n                this._updateClassName();\r\n            }\r\n        };\r\n        classListProto.remove = function () {\r\n            var\r\n            tokens = arguments\r\n            , i = 0\r\n            , l = tokens.length\r\n            , token\r\n            , updated = false\r\n            , index\r\n            ;\r\n            do {\r\n                token = tokens[i] + \"\";\r\n                index = checkTokenAndGetIndex(this, token);\r\n                while (index !== -1) {\r\n                    this.splice(index, 1);\r\n                    updated = true;\r\n                    index = checkTokenAndGetIndex(this, token);\r\n                }\r\n            }\r\n            while (++i < l);\r\n\r\n            if (updated) {\r\n                this._updateClassName();\r\n            }\r\n        };\r\n        classListProto.toggle = function (token, force) {\r\n            token += \"\";\r\n\r\n            var\r\n            result = this.contains(token)\r\n            , method = result ?\r\n                force !== true && \"remove\"\r\n                :\r\n                force !== false && \"add\"\r\n            ;\r\n\r\n            if (method) {\r\n                this[method](token);\r\n            }\r\n\r\n            if (force === true || force === false) {\r\n                return force;\r\n            } else {\r\n                return !result;\r\n            }\r\n        };\r\n        classListProto.toString = function () {\r\n            return this.join(\" \");\r\n        };\r\n\r\n        if (objCtr.defineProperty) {\r\n            var classListPropDesc = {\r\n                get: classListGetter, enumerable: true, configurable: true\r\n            };\r\n            try {\r\n                objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\r\n            } catch (ex) { // IE 8 doesn't support enumerable:true\r\n                if (ex.number === -0x7FF5EC54) {\r\n                    classListPropDesc.enumerable = false;\r\n                    objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\r\n                }\r\n            }\r\n        } else if (objCtr[protoProp].__defineGetter__) {\r\n            elemCtrProto.__defineGetter__(classListProp, classListGetter);\r\n        }\r\n    }());\r\n} else {\r\n    // There is full or partial native classList support, so just check if we need\r\n    // to normalize the add/remove and toggle APIs.\r\n    (function () {\r\n        \"use strict\";\r\n\r\n        var testElement = window.document.createElement(\"_\");\r\n\r\n        testElement.classList.add(\"c1\", \"c2\");\r\n\r\n        // Polyfill for IE 10/11 and Firefox <26, where classList.add and\r\n        // classList.remove exist but support only one argument at a time.\r\n        if (!testElement.classList.contains(\"c2\")) {\r\n            var createMethod = function(method) {\r\n                var original = DOMTokenList.prototype[method];\r\n\r\n                DOMTokenList.prototype[method] = function(token) {\r\n                    var i, len = arguments.length;\r\n\r\n                    for (i = 0; i < len; i++) {\r\n                        token = arguments[i];\r\n                        original.call(this, token);\r\n                    }\r\n                };\r\n            };\r\n            createMethod('add');\r\n            createMethod('remove');\r\n        }\r\n\r\n        testElement.classList.toggle(\"c3\", false);\r\n\r\n        // Polyfill for IE 10 and Firefox <24, where classList.toggle does not\r\n        // support the second argument.\r\n        if (testElement.classList.contains(\"c3\")) {\r\n            var _toggle = DOMTokenList.prototype.toggle;\r\n\r\n            DOMTokenList.prototype.toggle = function(token, force) {\r\n                if (1 in arguments && !this.contains(token) === !force) {\r\n                    return force;\r\n                } else {\r\n                    return _toggle.call(this, token);\r\n                }\r\n            };\r\n\r\n        }\r\n        testElement = null;\r\n    }());\r\n}\r\n }\r\n","window['#x-widget']=function(exports,module){  \"use strict\";\r\n\r\n\r\nmodule.exports = function(id, modName, args) {\r\n    var dst = document.getElementById(id);\r\n    if (!dst) {\r\n        // This widget does not exist!\r\n        return;\r\n    }\r\n    var module = require(modName);\r\n    var src = new module(args);\r\n    src.element().$ctrl = src;\r\n    src = src.element();\r\n    src.setAttribute('id', id);\r\n    dst.parentNode.replaceChild(src, dst);\r\n};\r\n }\r\n","window['#depiler2bouts.main']=function(exports,module){  \"use strict\";\r\nvar Triangle = require(\"svg.triangle\");\r\nvar Widget = require(\"wdg\");\r\nvar Bulle = require(\"tp4.bulle\");\r\n\r\nvar D = Widget.div;\r\nvar T = Widget.tag;\r\n\r\n\r\n/**\r\n * @example\r\n * var Main = require(\"depiler2bouts.main\");\r\n * var instance = new Main();\r\n * @class Main\r\n */\r\nvar Main = function(disableInteractivity) {\r\n    Widget.call(this);\r\n    this.addClass(\"depiler2bouts-main\");\r\n    var nbPieces = 10;\r\n    this._pieces = createPieces.call(this, nbPieces);\r\n    if (disableInteractivity) {\r\n        var pts1 = 0;\r\n        var pts2 = 0;\r\n        while (pts1 <= pts2) {\r\n            this.shuffle();\r\n            this._pieces.forEach(function (piece, idx) {\r\n                if (idx % 2 == 0) {\r\n                    pts1 += parseInt(piece.text());\r\n                } else {\r\n                    pts2 += parseInt(piece.text());\r\n                }\r\n            });\r\n        }\r\n        pts1 = pts2 = 0;\r\n        var w1 = D('pts1').text(0), w2 = D('pts2').text(0);\r\n        this.append(D('tbl').append(w1, w2));\r\n        this._pieces.forEach(function (piece, idx) {\r\n            if (idx % 2 == 0) {\r\n                this.flip(piece, 'you', idx * 100 + 1000, function(p) {\r\n                    pts1 += parseInt(p.text());\r\n                    w1.text(pts1);\r\n                });\r\n            } else {\r\n                this.flip(piece, 'him', idx * 100 + 1000, function(p) {\r\n                    pts2 += parseInt(p.text());\r\n                    w2.text(pts2);\r\n                });\r\n            }\r\n        }, this);\r\n        return;\r\n    }\r\n    createScores.call(this);\r\n    this.reset();\r\n};\r\n\r\nfunction createScores() {\r\n    var that = this;\r\n    var btnResetYou = T('a', 'button').attr('href', '#')\r\n        .append(Triangle({angle: 180, width: '24px', height: '30px'}))\r\n        .Tap(function() {\r\n            that.reset(false);\r\n        });\r\n    var btnResetHim = T('a', 'button').attr('href', '#')\r\n        .append(Triangle({angle: 0, width: '24px', height: '30px'}))\r\n        .Tap(function() {\r\n            that.reset(true);\r\n        });\r\n    var pts1 = D(\"pts1\").text(\"0\");\r\n    var pts2 = D(\"pts2\").text(\"0\");\r\n    var delta = D('delta');\r\n    var tbl = D('tbl').append(\r\n        D().append(\r\n            D().text(\"Vous\"),\r\n            pts1\r\n        ),\r\n        D().append(\r\n            D().text(\"recommencer:\"),\r\n            D().append(btnResetYou, T('span').html(\"&nbsp;&nbsp;\"), btnResetHim),\r\n            delta\r\n        ),\r\n        D().append(\r\n            D().text(\"Lui\"),\r\n            pts2\r\n        )\r\n    );\r\n    this._pts1 = pts1;\r\n    this._pts2 = pts2;\r\n    this._delta = delta;\r\n    return tbl.appendTo(this);\r\n}\r\n\r\nfunction createPieces(nbPieces) {\r\n    var that = this;\r\n    var onTap = function() {\r\n        that.onTap(this);\r\n    };\r\n    var pieces = [];\r\n    var i;\r\n    var div;\r\n    var piece;\r\n    for (i = 0 ; i < nbPieces ; i++) {\r\n        div = D('piece').appendTo(this);\r\n        piece = D().text(i + 1).attr('data-idx', i).Tap(onTap);\r\n        piece.parent = div;\r\n        div.append(piece);\r\n        pieces.push(piece);\r\n    }\r\n    return pieces;\r\n}\r\n\r\n// Extension of Widget.\r\nMain.prototype = Object.create(Widget.prototype);\r\nMain.prototype.constructor = Main;\r\n\r\n/**\r\n * @return void\r\n */\r\nMain.prototype.onTap = function(source) {\r\n    if (this._freeze) return;\r\n    var first = this._first;\r\n    var last = this._last;\r\n    if (first == last) {\r\n        if (source.hasClass('you') || source.hasClass('him')) {\r\n            return;\r\n        }\r\n    }\r\n    var index = parseInt(source.attr('data-idx'));\r\n    if (index != first && index != last) return;\r\n    var that = this;\r\n\r\n    if (this._first < this._last) {\r\n        // Schedule computer's turn only if there are still pieces on the table.\r\n        setTimeout(function() {\r\n            that.computersTurn();\r\n        }, 600);\r\n    }\r\n\r\n    if (index == first) {\r\n        this._first = Math.min(this._first + 1, this._last);\r\n    }\r\n    else if (index == last) {\r\n        this._last = Math.max(this._last - 1, this._first);\r\n    }\r\n    source.parent.addClass('flip');\r\n    setTimeout(function() {\r\n        source.addClass('you');\r\n        source.parent.removeClass('flip');\r\n    }, 300);\r\n    this.pts1(this.pts1() + parseInt(source.text()));\r\n    this._freeze = true;\r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nMain.prototype.flip = function(piece, classname, delay, onEndOfAnim) {\r\n    if (typeof delay === 'undefined') delay = 0;\r\n    setTimeout(function() {\r\n        piece.removeClass('you', 'him');\r\n        piece.parent.addClass('flip');\r\n    }, delay);\r\n    setTimeout(function() {\r\n        piece.addClass(classname);\r\n        piece.parent.removeClass('flip');\r\n    }, 300 + delay);\r\n    if (typeof onEndOfAnim === 'function') {\r\n        setTimeout(function() {\r\n            onEndOfAnim(piece);\r\n        }, 600 + delay);\r\n    }\r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nMain.prototype.computersTurn = function() {\r\n    var that = this;\r\n\r\n    this._freeze = false;\r\n    var values = [];\r\n    this._pieces.forEach(function (piece) {\r\n        values.push(parseInt(piece.text()));\r\n    });\r\n\r\n    var first = this._first;\r\n    var last = this._last;\r\n    var index = first;\r\n\r\n    if (first != last) {\r\n        var a = max(values, first + 1, last) - values[first];\r\n        var b = max(values, first, last - 1) - values[last];\r\n        if (a < b) {\r\n            index = first;\r\n            this._first++;\r\n        } else {\r\n            index = last;\r\n            this._last--;\r\n        }\r\n        var pts1 = parseInt(this._pts1.text());\r\n        var pts2 = parseInt(this._pts2.text());\r\n        console.info(\"[depiler2bouts.main] a=...\", a, \" -> \",\r\n                     pts1 - pts2 + a);\r\n        console.info(\"[depiler2bouts.main] b=...\", b, \" -> \",\r\n                     pts1 - pts2 + b);\r\n    }\r\n    var piece = this._pieces[index];\r\n    piece.parent.addClass('flip');\r\n    setTimeout(function() {\r\n        piece.addClass('him');\r\n        piece.parent.removeClass('flip');\r\n    }, 300);\r\n    setTimeout(function() {\r\n        if (!that._computerHasAlreadySpoken) {\r\n            var avance = Math.min(pts1 - pts2 + a, pts1 - pts2 + b);\r\n            if (avance < 0) {\r\n                Bulle.show(\r\n                    that._pts2,\r\n                    \"<html>Je parie que je vais gagner avec au moins <b>\"\r\n                        + Math.abs(avance)\r\n                        + \"</b> points d'avance.\"\r\n                );\r\n                that._computerHasAlreadySpoken = true;\r\n            }\r\n        }\r\n    }, 600);\r\n    this.pts2(this.pts2() + parseInt(piece.text()));\r\n};\r\n\r\nfunction max(values, F, L) {\r\n    if (F == L) return values[F];\r\n    return Math.max(\r\n        values[F] + min(values, F + 1, L),\r\n        values[L] + min(values, F, L - 1)\r\n    );\r\n}\r\n\r\nfunction min(values, F, L) {\r\n    if (F == L) return -values[F];\r\n    return Math.min(\r\n            - values[F] + max(values, F + 1, L),\r\n            - values[L] + max(values, F, L - 1)\r\n    );\r\n}\r\n\r\n/**\r\n * Getter/Setter for points of YOU.\r\n */\r\nMain.prototype.pts1 = function(v) {\r\n    if (typeof v === 'undefined') return parseInt(this._pts1.text());\r\n    this._pts1.text(\"\" + v);\r\n    this.setDelta();\r\n    return this;\r\n};\r\n\r\n/**\r\n * Getter/Setter for points of HIM.\r\n */\r\nMain.prototype.pts2 = function(v) {\r\n    if (typeof v === 'undefined') return parseInt(this._pts2.text());\r\n    this._pts2.text(\"\" + v);\r\n    this.setDelta();\r\n    return this;\r\n};\r\n\r\n\r\n/**\r\n * @return void\r\n */\r\nMain.prototype.setDelta = function() {\r\n    var v = this.pts1() - this.pts2();\r\n    var delta = this._delta;\r\n    if (v > 0) {\r\n        v = \"+\" + v;\r\n        delta.addClass(\"you\").removeClass(\"him\");\r\n    }\r\n    else if (v < 0) {\r\n        delta.addClass(\"him\").removeClass(\"you\");\r\n    }\r\n    delta.text(\"\" + v);\r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nMain.prototype.shuffle = function() {\r\n    var values = [1,2,3,4,5,6,7,8,9,10];\r\n    var j, tmp;\r\n    for (var i = 0 ; i < 10 ; i++) {\r\n        j = Math.floor(Math.random() * 10);\r\n        tmp = values[i];\r\n        values[i] = values[j];\r\n        values[j] = tmp;\r\n        this._pieces[i].removeClass('you', 'him');\r\n    }\r\n\r\n    this._pieces.forEach(function (piece, idx) {\r\n        piece.text(values[idx]);\r\n    });    \r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nMain.prototype.reset = function(heStartsFirst) {\r\n    this._computerHasAlreadySpoken = false;\r\n    this.shuffle();\r\n    this.pts1(0);\r\n    this.pts2(0);\r\n    this._first = 0;\r\n    this._last = this._pieces.length - 1;\r\n    this._freeze = false;\r\n    if (heStartsFirst) {\r\n        this.computersTurn();\r\n    }\r\n};\r\n\r\n\r\nMain.create = function() {\r\n    return new Main();\r\n};\r\nmodule.exports = Main;\r\n }\r\n","window['#tp4.bulle']=function(exports,module){ var _intl_={\"en\":{\"close\":\"Close\",\"later\":\"Later!\",\"next\":\"Next\"},\"fr\":{\"close\":\"Fermer\",\"later\":\"Plus tard!\",\"next\":\"Suivant\"}},_$=require(\"$\").intl;function _(){return _$(_intl_, arguments);}\r\n var Widget = require(\"wdg\");\r\nvar D = Widget.div;\r\n\r\nvar container = null;\r\n\r\nfunction hide() {\r\n    if (!container) return;\r\n    container.detach();\r\n    container = null;\r\n}\r\n\r\nfunction show(target, content) {\r\n    if (typeof content === 'string') {\r\n        if (content.substr(0, 6) == '<html>') {\r\n            content = D().html(content.substr(6));\r\n        } else {\r\n            content = D().text(content);\r\n        }\r\n    }\r\n    \r\n    var rect = target.rect();\r\n    var x = rect.left + rect.width / 2;\r\n    var y = rect.top + rect.height / 2;\r\n    var centerX = document.body.getBoundingClientRect().width / 2;\r\n    var centerY = document.body.getBoundingClientRect().height / 2;\r\n    var dirH = x > centerX ? \"right\" : \"left\";\r\n    var dirV = y > centerY ? \"bottom\" : \"top\";\r\n    var w = D(\"tp4-bulle\", dirH, dirV);\r\n    var frame = D('frame');\r\n    var center = Widget.tag(\"center\").css(\"marginTop\", \"10px\");\r\n    var div = D(\"content\").append(content, center);\r\n    if (dirH == \"right\") x -= 240;\r\n    w.css(\r\n        {\r\n            left: x + \"px\",\r\n            top: y + \"px\"\r\n        }\r\n    );\r\n    w.append(frame);\r\n    if (dirV == 'top') {\r\n        frame.append(D(\"svg\"), div);\r\n    } else {\r\n        frame.append(div, D(\"svg\"));\r\n    }\r\n    container = D(\"tp4-bulle-container\").append(w).appendToBody();\r\n    container.Tap(hide);\r\n    setTimeout(\r\n        function() {\r\n            w.addClass(\"show\");\r\n        }\r\n    );\r\n};\r\n\r\nexports.show = show;\r\nexports.hide = hide;\r\n }\r\n","window['#svg.triangle']=function(exports,module){  \"use strict\";\r\nvar Widget = require(\"wdg\");\r\nvar Svg = Widget.svg;\r\n\r\nmodule.exports = function(options) {\r\n    if (typeof options === 'undefined') options = {};\r\n    if (typeof options.width === 'undefined') options.width = '1em';\r\n    if (typeof options.height === 'undefined') options.height = '1em';\r\n    if (typeof options.angle === 'undefined') options.angle = 0;\r\n    if (typeof options.fill === 'undefined') options.fill = '#000';\r\n\r\n    var root = Svg({\r\n        viewBox: \"-105 -105 210 210\",\r\n        width: options.width,\r\n        height: options.height\r\n    });\r\n\r\n    root.append(\r\n        Svg('path', {\r\n            fill: options.fill,\r\n            stroke: options.stroke ? options.stroke : 'none',\r\n            transform: \"rotate(\" + options.angle + \")\",\r\n            d: \"M100,0L-70.71,-70.71L-40,0L-70.71,70.71Z\"\r\n        })\r\n    );\r\n    \r\n    return root;\r\n};\r\n }\r\n"],"names":["addListener","e","l","window","addEventListener","attachEvent","require","modules","id","body","mod","err","Error","console","error","stack","exports","document","parentNode","$data","x","header","footer","grader","shuffle","arr","i","j","tmp","length","Math","floor","random","this","expect","toBe","loop","ex","args","fail","JSON","stringify","wrapper","f","max","values","F","L","min","choice","gain","window","exports","module","config","name","description","author","version","major","minor","revision","date","Date","currentLang","lang","undefined","localStorage","getItem","navigator","language","browserLanguage","substr","toLowerCase","setItem","intl","words","params","txt","newTxt","i","c","lastIdx","pos","dic","k","length","charAt","substring","charCodeAt","window","exports","module","Jasmine","wrapper","this","_runtime","_wrapper","Runtime","result","args","_inverted","_result","_args","Widget","require","D","div","T","tag","Grader","options","console","info","that","call","addClass","_options","header","append","text","area","attr","cols","rows","localStorage","getItem","footer","btn","Tap","grade","element","value","setItem","ok","error","_btn","_ok","_error","addEventListener","removeAttr","removeClass","prototype","Object","create","constructor","testContent","opt","f","eval","ex","fail","grader","jasmine","txt","msg","expect","i","arguments","length","push","apply","runtime","not","toBe","JSON","stringify","expected","window","exports","module","Widget","options","this","__data","e","innerHTML","childNodes","element","tag","id","document","getElementById","Error","createElement","addClass","ex","console","error","JSON","stringify","prototype","v","undefined","_element","querySelector","data","k","detach","p","parentNode","removeChild","addEvent","name","slot","sender","key","x","f","call","addEventListener","evt","preventDefault","stopPropagation","removeAttr","i","arg","arguments","length","removeAttribute","hasAttribute","attr","val","ns","getAttribute","className","setAttributeNS","setAttribute","text","css","style","insertAfter","target","insertBefore","nextSibling","append","createTextNode","Array","isArray","forEach","item","appendChild","appendTo","parent","onAppend","appendToBody","body","hasClass","classList","contains","trim","add","removeClass","remove","toggleClass","toggle","clear","firstChild","child","nodeType","nodeValue","html","focus","rect","getBoundingClientRect","Tap","_Tap","that","activatePointerEvents","_pointerEvents","start","pe","touch","Date","now","tap","delta","div","isInDOM","create","args","find","query","svg","attribs","namespace","createElementNS","w","version","viewBox","width","height","span","testElement","createMethod","method","original","DOMTokenList","token","len","_toggle","force","classListProp","protoProp","elemCtrProto","Element","objCtr","Object","strTrim","String","rx","RegExp","replace","arrIndexOf","indexOf","DOMEx","type","message","code","DOMException","checkTokenAndGetIndex","test","ClassList","elem","trimmedClasses","classes","split","push","_updateClassName","toString","classListProto","classListGetter","tokens","l","updated","index","splice","result","join","defineProperty","classListPropDesc","get","enumerable","configurable","number","__defineGetter__","window","exports","module","id","modName","args","dst","document","getElementById","require","src","element","$ctrl","setAttribute","parentNode","replaceChild","window","exports","module","createScores","that","this","btnResetYou","T","attr","append","Triangle","angle","width","height","Tap","reset","btnResetHim","pts1","D","text","pts2","delta","tbl","html","_pts1","_pts2","_delta","appendTo","createPieces","nbPieces","i","div","piece","onTap","pieces","parent","push","max","values","F","L","Math","min","require","Widget","Bulle","tag","Main","disableInteractivity","call","addClass","_pieces","shuffle","forEach","idx","parseInt","w1","w2","flip","p","prototype","Object","create","constructor","source","_freeze","first","_first","last","_last","hasClass","index","setTimeout","computersTurn","removeClass","classname","delay","onEndOfAnim","a","b","console","info","_computerHasAlreadySpoken","avance","show","abs","v","setDelta","j","tmp","floor","random","heStartsFirst","length","window","exports","module","hide","container","detach","show","target","content","substr","D","html","text","rect","x","left","width","y","top","height","centerX","document","body","getBoundingClientRect","centerY","dirH","dirV","w","frame","center","Widget","tag","css","div","append","appendToBody","Tap","setTimeout","addClass","require","intl","window","exports","module","Widget","require","Svg","svg","options","width","height","angle","fill","root","viewBox","append","stroke","transform","d"],"mappings":"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"}