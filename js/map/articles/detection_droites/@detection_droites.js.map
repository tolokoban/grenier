{"version":3,"file":"articles/detection_droites/@detection_droites.js.map","sources":["articles/detection_droites/@detection_droites.js","$.js","detection_droites.js"],"sourcesContent":["var require = function() {\n    var modules = {};\n    \n    return function(id, body) {\n        var mod;\n        body = window[\"#\" + id];\n        if (typeof body === 'undefined') {\n            var err = new Error(\"Required module is missing: \" + id);   \n            console.error(err.stack);\n            throw err;\n        }\n        mod = modules[id];\n        if (typeof mod === 'undefined') {\n            mod = {exports: {}};\n            var exports = mod.exports;\n            body(exports, mod);\n            modules[id] = mod.exports;\n            mod = mod.exports;\n            //console.log(\"Module initialized: \" + id);\n        }\n        return mod;\n    };\n}();\nfunction addListener(e,l) {\n    if (window.addEventListener) {\n        window.addEventListener(e,l,false);\n    } else {\n        window.attachEvent('on' + e, l);\n    }\n};\n\naddListener(\n    'DOMContentLoaded',\n    function() {\n        document.body.parentNode.$data = {};\n        // Attach controllers.\n        APP = require('detection_droites');\nsetTimeout(function (){if(typeof APP.start==='function')APP.start()});\n    }\n);\n","window['#$']=function(exports,module){  exports.config={\n    name:\"grenier\",\n    description:\"Articles concernant majoritairement l'algorithmie\",\n    author:\"Tolokoban\",\n    version:\"1.0.515\",\n    major:1,\n    minor:0,\n    revision:515,\n    date:new Date(2016,1,4,18,34,34)\n};\nvar currentLang = null;\r\nexports.lang = function(lang) {\r\n    if (lang === undefined) {\r\n        lang = window.localStorage.getItem(\"Language\");\r\n        if (!lang) {\r\n            lang = window.navigator.language;\r\n            if (!lang) {\r\n                lang = window.navigator.browserLanguage;\r\n                if (!lang) {\r\n                    lang = \"fr\";\r\n                }\r\n            }\r\n        }\r\n        lang = lang.substr(0, 2).toLowerCase();\r\n    }\r\n    currentLang = lang;\r\n    window.localStorage.setItem(\"Language\", lang);\r\n    return lang;\r\n};\r\nexports.intl = function(words, params) {\r\n    var dic = words[exports.lang()],\r\n    k = params[0],\r\n    txt, newTxt, i, c, lastIdx, pos;\r\n    if (!dic) {\r\n        //console.error(\"Missing internationalization for language : \\\"\" + exports.lang() + \"\\\"!\");\r\n        return k;\r\n    }\r\n    txt = dic[k];\r\n    if (!txt) {\r\n        //console.error(\"Missing internationalization [\" + exports.lang() + \"]: \\\"\" + k + \"\\\"!\");\r\n        return k;\r\n    }\r\n    if (params.length > 1) {\r\n        newTxt = \"\";\r\n        lastIdx = 0;\r\n        for (i = 0 ; i < txt.length ; i++) {\r\n            c = txt.charAt(i);\r\n            if (c === '$') {\r\n                newTxt += txt.substring(lastIdx, i);\r\n                i++;\r\n                pos = txt.charCodeAt(i) - 48;\r\n                if (pos < 0 || pos >= params.length) {\r\n                    newTxt += \"$\" + txt.charAt(i);\r\n                } else {\r\n                    newTxt += params[pos];\r\n                }\r\n                lastIdx = i + 1;\r\n            } else if (c === '\\\\') {\r\n                newTxt += txt.substring(lastIdx, i);\r\n                i++;\r\n                newTxt += txt.charAt(i);\r\n                lastIdx = i + 1;\r\n            }\r\n        }\r\n        newTxt += txt.substr(lastIdx);\r\n        txt = newTxt;\r\n    }\r\n    return txt;\r\n};\r\n }\n","window['#detection_droites']=function(exports,module){  exports.start = function() {\r\n    var img = document.getElementById(\"image\");\r\n    //img.src = \"sample.jpg\";\r\n    img.onload = function() {\r\n        var content = document.getElementById(\"sample\");\r\n        var out = '';\r\n        var points = extractPointsFromImage(img);\r\n        computeRadius(points);\r\n        out += \"<div class='grid'>\";\r\n        points.forEach(function (point) {\r\n            out += '<div>';\r\n            out += '<div>' + point[0] + \",\" + point[1] + '</div>';\r\n            for (var i=2; i<point.length; i++) {\r\n                out += '<div>' + point[i] + '</div>';\r\n            }\r\n            out += '</div>';\r\n        });\r\n        out += \"</div>\";\r\n        content.innerHTML = out;\r\n    };\r\n};\r\n\r\n/**\r\n * @return\r\n * An array of black points. Each point  is an array with two items: x\r\n * and y.\r\n */\r\nfunction extractPointsFromImage(img) {\r\n    var canvas = document.createElement(\"canvas\");\r\n    canvas.setAttribute(\"width\", img.width);\r\n    canvas.setAttribute(\"height\", img.height);\r\n    var ctx = canvas.getContext(\"2d\");\r\n    ctx.drawImage(img, 0, 0);\r\n    var buffer = ctx.getImageData(0, 0, img.width, img.height).data;\r\n    var points = [];\r\n    var index = 0;\r\n    var value;\r\n    var w, h;\r\n\r\n    for (h = 0; h < img.height; h++) {\r\n        for (w = 0; w < img.width; w++) {\r\n            value = buffer[index++] + buffer[index++] + buffer[index++];\r\n            if (value < 30) {\r\n                points.push([w,h]);\r\n            }\r\n            index++;\r\n        }\r\n    }\r\n\r\n    return points;\r\n}\r\n\r\n\r\n/**\r\n * `points` is an array of points. A point is an array with two items:\r\n * x and y.  This function adds 36  items to each point: there are the\r\n * 36 values of R given A in {0째, 10째, 20째, ..., 350째}.\r\n */\r\nfunction computeRadius(points) {\r\n    var COS = [], SIN = [],\r\n        i,\r\n        angle = 0,\r\n        angleStep = Math.PI / 18;\r\n    for (i = 0; i < 36; i++) {\r\n        COS.push(Math.cos(angle));\r\n        SIN.push(Math.cos(angle));\r\n        angle += angleStep;\r\n    }\r\n\r\n    points.forEach(function (point) {\r\n        var x = point[0],\r\n            y = point[1];\r\n        COS.forEach(function (c, idx) {\r\n            var s = SIN[idx],\r\n                r = 2 * Math.floor(.5 + (x * c + y * s) / 2);\r\n            point.push(r);\r\n        });\r\n    });\r\n}\r\n }\n"],"names":["addListener","e","l","window","addEventListener","attachEvent","require","modules","id","body","mod","err","Error","console","error","stack","exports","document","parentNode","$data","APP","setTimeout","start","window","exports","module","config","name","description","author","version","major","minor","revision","date","Date","currentLang","lang","undefined","localStorage","getItem","navigator","language","browserLanguage","substr","toLowerCase","setItem","intl","words","params","txt","newTxt","i","c","lastIdx","pos","dic","k","length","charAt","substring","charCodeAt","window","exports","module","extractPointsFromImage","img","canvas","document","createElement","setAttribute","width","height","ctx","getContext","drawImage","value","w","h","buffer","getImageData","data","points","index","push","computeRadius","i","COS","SIN","angle","angleStep","Math","PI","cos","forEach","point","x","y","c","idx","s","r","floor","start","getElementById","onload","content","out","length","innerHTML"],"mappings":"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"}